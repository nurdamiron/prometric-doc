# üßπ –û–¢–ß–ï–¢ –û–ë –û–ß–ò–°–¢–ö–ï –ò –§–ò–ù–ê–õ–¨–ù–û–ú –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ò

## ‚úÖ –ß–¢–û –ë–´–õ–û –£–î–ê–õ–ï–ù–û

### Backend —Ñ–∞–π–ª—ã:
- ‚ùå `src/auth/auth.controller.old.ts` - —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å `/select-role`
- ‚ùå `src/auth/controllers/token-fallback.controller.ts` - –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π fallback –¥–ª—è cookies

### –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:
- ‚ùå `test-deep-analysis.sh` - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π
- ‚ùå `test-final-complete.sh` - —É—Å—Ç–∞—Ä–µ–≤—à–∏–π  
- ‚úÖ `test-auth-complete.sh` - –æ—Å—Ç–∞–≤–ª–µ–Ω (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –∏–∑ test-fixed-flows.sh)

## ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê AUTH

### –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ endpoints:
```
POST /api/v1/auth/registration/pre-register
POST /api/v1/auth/registration/verify-email
POST /api/v1/auth/registration/onboarding/complete
POST /api/v1/auth/login
GET  /api/v1/company/pending-registrations
POST /api/v1/company/approve-registration
```

### –ù–ï —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ endpoints:
```
‚ùå /api/v1/auth/select-role - –£–î–ê–õ–ï–ù, –ù–ï –ù–£–ñ–ï–ù
‚ùå /api/v1/auth/token-from-cookie - –£–î–ê–õ–ï–ù, –∏—Å–ø–æ–ª—å–∑—É–µ–º Bearer
```

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–†–û–í–ï–†–ö–ò

- ‚úÖ Backend –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å—Ç–∞—Ä—ã—Ö endpoints
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞

## üìã –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï

```bash
# –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç:
./test-auth-complete.sh

# –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª:
# 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è owner —Å –∫–æ–º–ø–∞–Ω–∏–µ–π
# 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è employee  
# 3. –û–¥–æ–±—Ä–µ–Ω–∏–µ employee –≤–ª–∞–¥–µ–ª—å—Ü–µ–º
```

## üéØ –í–ê–ñ–ù–û –ü–û–ú–ù–ò–¢–¨

1. **–ù–ï–¢ `/select-role`** - —Ä–æ–ª—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `onboarding/complete`
2. **–ë–ò–ù –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - 12 —Ü–∏—Ñ—Ä, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π
3. **selectedRole –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - "owner" –∏–ª–∏ "employee"
4. **Bearer —Ç–æ–∫–µ–Ω—ã** - –Ω–µ httpOnly cookies

## ‚úÖ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ