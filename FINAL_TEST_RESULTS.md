# üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –§–ò–ù–ê–õ–¨–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø AUTH FLOWS

## üìÖ –î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: 22 –∞–≤–≥—É—Å—Ç–∞ 2025
## ‚è∞ Timestamp: 1755890685

---

## üéØ –û–ë–©–ò–ô –°–¢–ê–¢–£–°: –ß–ê–°–¢–ò–ß–ù–û –£–°–ü–ï–®–ù–û (75%)

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **Pre-registration** - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è owner –∏ employee
2. **Email verification** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤ –∏–∑ –ë–î
3. **–ë–ò–ù –≤–∞–ª–∏–¥–∞—Ü–∏—è** - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —É—Å–ø–µ—à–Ω–æ –Ω–∞—Ö–æ–¥—è—Ç –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –ø–æ –ë–ò–ù
4. **Security features** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–æ–¥–æ–≤ (123456, 000000) —Ä–∞–±–æ—Ç–∞–µ—Ç
5. **Pending status** - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –¥–æ –æ–¥–æ–±—Ä–µ–Ω–∏—è
6. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∏–º–µ–Ω/—Ñ–∞–º–∏–ª–∏–π (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã) —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:
1. **Onboarding flow** - —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
   - –°–Ω–∞—á–∞–ª–∞ `/select-role` 
   - –ó–∞—Ç–µ–º `/onboarding/complete`
   - –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —ç—Ç–æ –Ω–µ —è—Å–Ω–æ –æ–ø–∏—Å–∞–Ω–æ

2. **–í–∞–ª–∏–¥–∞—Ü–∏—è lastName** - –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ü–∏—Ñ—Ä—ã (–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã)

---

## üìä –î–ï–¢–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### 1Ô∏è‚É£ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –í–õ–ê–î–ï–õ–¨–¶–ê

```
Email: owner_1755890685@prometric.kz
Password: SecureOwner123!
Company: –¢–û–û –ö–æ–º–ø–∞–Ω–∏—è 1755890685
BIN: (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏–∑ timestamp)
```

**–®–∞–≥–∏:**
- ‚úÖ Pre-registration: —É—Å–ø–µ—à–Ω–æ (User ID: 28b6175b-fd27-4c15-aa9c-b18577fa28b3)
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ –ë–î: —É—Å–ø–µ—à–Ω–æ (–∫–æ–¥: 440746)
- ‚úÖ Email verification: —É—Å–ø–µ—à–Ω–æ (—Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω)
- ‚ùå Onboarding/complete: –Ω–µ—É–¥–∞—á–Ω–æ (–æ—à–∏–±–∫–∞: "Selected role is required")

**–ü—Ä–æ–±–ª–µ–º–∞:** API –æ–∂–∏–¥–∞–µ—Ç, —á—Ç–æ —Ä–æ–ª—å –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω–∞ —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint `/select-role` –ø–µ—Ä–µ–¥ onboarding.

### 2Ô∏è‚É£ –ü–†–ê–í–ò–õ–¨–ù–´–ô FLOW (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)

–ê–Ω–∞–ª–∏–∑–∏—Ä—É—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π flow –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:

1. **POST /auth/registration/pre-register** - —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. **POST /auth/registration/verify-email** - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email
3. **POST /auth/registration/select-role** - –≤—ã–±–æ—Ä —Ä–æ–ª–∏ (owner/employee)
4. **POST /auth/registration/complete-onboarding** - –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ù–æ –≤ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ endpoint `/select-role` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω.

---

## üîê –í–ê–ñ–ù–´–ï –ù–ê–•–û–î–ö–ò

### Security Features:
1. **–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–¥—ã:**
   ```javascript
   const blockedCodes = ['123456', '000000', '111111', '999999'];
   ```
   –í—Å–µ —ç—Ç–∏ –∫–æ–¥—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç - –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑ –ë–î.

2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ –ë–î:**
   ```bash
   PGPASSWORD=prometric01 psql \
     -h prometric.cde42ec8m1u7.eu-north-1.rds.amazonaws.com \
     -U prometric -d prometric -t \
     -c "SELECT code FROM email_verifications WHERE email = 'email@test.com' ORDER BY created_at DESC LIMIT 1;"
   ```

3. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω:**
   - –¢–æ–ª—å–∫–æ –±—É–∫–≤—ã, –ø—Ä–æ–±–µ–ª—ã, –¥–µ—Ñ–∏—Å—ã, –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã
   - –ù–∏–∫–∞–∫–∏—Ö —Ü–∏—Ñ—Ä –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –≠—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã —Å timestamp –≤ –∏–º–µ–Ω–∞—Ö

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –î–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤:
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞ –±–µ–∑ —Ü–∏—Ñ—Ä
2. –ü–æ–ª—É—á–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã –∏–∑ –ë–î
3. –°–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É flow —Å select-role

### –î–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã:
1. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º flow
2. –°–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
3. –î–æ–±–∞–≤–∏—Ç—å endpoint health check –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö endpoints

---

## üéØ –§–ò–ù–ê–õ–¨–ù–ê–Ø –û–¶–ï–ù–ö–ê

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å |
|-----------|--------|------------|
| Pre-registration | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 100% |
| Email verification | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 100% |
| –ë–ò–ù –≤–∞–ª–∏–¥–∞—Ü–∏—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 100% |
| Security (blocked codes) | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | 100% |
| Onboarding flow | ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã | 50% |
| Employee approval | ‚ö†Ô∏è –ù–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ | - |
| Department assignment | ‚ö†Ô∏è –ù–µ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ | - |

**–û–±—â–∞—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å Auth –º–æ–¥—É–ª—è: 75%**

---

## üìå –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å flow –≤ —Ç–µ—Å—Ç–∞—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é endpoints
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å employee approval –∏ department assignment
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –Ω–∞–π–¥–µ–Ω–Ω—ã–º–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è–º–∏
4. –°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –±–µ–∑ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∏–º–µ–Ω